(this.webpackJsonpsoftlex=this.webpackJsonpsoftlex||[]).push([[0],{45:function(e,t,a){},71:function(e,t,a){"use strict";a.r(t);a(40);var n=a(1),s=a.n(n),c=a(37),r=a.n(c),i=(a(45),a(4)),o=a(11),l=a.n(o),d=a(3),u=a(13),b=a(38),j=a.n(b),m="abc",O=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),s=a[0],c=a[1],r=Object(n.useState)(null),o=Object(i.a)(r,2),b=o[0],m=o[1],O=Object(n.useState)(null),f=Object(i.a)(O,2),p=f[0],h=f[1],v=Object(n.useState)({}),g=Object(i.a)(v,2),x=g[0],k=g[1],y="https://uxcandy.com/~shapoval/test-task-backend/v2",N="Artemiy Zebzeev",C=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};k(e),m(null),h(null),c(!0)}),[]),T=x.method,E=void 0===T?"GET":T,w=x.params,S=x.form;return Object(n.useEffect)((function(){if(s){var t={method:E,baseURL:y,url:e,headers:{"Content-Type":"POST"===E?"multipart/form-data":"application/json"},params:w?Object(d.a)(Object(d.a)({},w),{},{developer:N}):{developer:N},data:"GET"!==E?S:null};(function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()(t).then((function(e){if(c(!1),"ok"!==e.data.status){var t=new Error;throw t.message=e.data.message,t}m(e.data)})).catch((function(e){c(!1),h(e.message)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}}),[s,y,N,S,E,w,e]),[{isLoading:s,response:b,error:p},C]},f="setActivePage",p="sortingTasks",h="setTasks",v="setTask",g="setEditedTask",x="setFormData",k="clearForm",y="setToken",N="setEditId",C="setError",T=function(e,t){return{type:x,payload:{field:e,value:t}}},E=function(){return{type:k}},w=function(e){return{type:y,payload:{token:e}}},S=function(e){return{type:N,payload:{taskId:e}}},P=a(20),L=function(e,t){switch(t.type){case x:return Object(d.a)(Object(d.a)({},e),{},Object(P.a)({},t.payload.field,t.payload.value));case k:for(var a=e,n=0,s=Object.entries(a);n<s.length;n++){a[Object(i.a)(s[n],1)[0]]=""}return a;default:return e}},I=function(e){for(var t=new FormData,a=0,n=Object.entries(e);a<n.length;a++){var s=Object(i.a)(n[a],2),c=s[0],r=s[1];t.append(c,r.toString())}return t},F={0:"\u0417\u0430\u0434\u0430\u0447\u0430 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430",1:"\u0417\u0430\u0434\u0430\u0447\u0430 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430, \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0430\u0434\u043c\u0438\u043d\u043e\u043c",10:"\u0417\u0430\u0434\u0430\u0447\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430",11:"\u0417\u0430\u0434\u0430\u0447\u0430 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u0430\u0434\u043c\u0438\u043d\u043e\u043c \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430"},D=function(e){return F[e]},R=function(e){return{done:Math.round(e/10),adminEdit:e%10}},_=a(0),A={},M=function(e){var t=e.setTaskToState,a=e.setEditedTaskToState,s=e.taskToEdit,c=e.setId,r=e.token,o=e.setError,b=Object(n.useReducer)(L,A),j=Object(i.a)(b,2),m=j[0],f=j[1],p=Object(n.useState)((function(){return s?"/edit/".concat(s.id):"/create"})),h=Object(i.a)(p,2),v=h[0],g=h[1],x=O(v),k=Object(i.a)(x,2),y=k[0],N=y.response,C=y.error,w=y.isLoading,S=k[1],P=Object(n.useState)((function(){return s?10*R(s.status).done:0})),F=Object(i.a)(P,2),D=F[0],M=F[1],U=Object(n.useState)((function(){return s?R(s.status).adminEdit:0})),B=Object(i.a)(U,2),G=B[0],J=B[1],z=Object(n.useState)(null),H=Object(i.a)(z,2),Z=H[0],q=H[1],K=function(e){var t=e.currentTarget,a=t.value,n=t.dataset.field;s&&!G&&J(1),f(T(n,a))},Q=Object(n.useCallback)((function(){f(E())}),[]),V=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=I(m),s&&(g("/edit/".concat(s.id)),a.append("status",(D+G).toString()),a.append("token",r)),s&&(n=Object(d.a)(Object(d.a)({},m),{},{status:D+G}),q(n)),e.next=6,S({method:"POST",form:a});case 6:Q(),c(null);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){if(s){for(var e=0,t=Object.entries(s);e<t.length;e++){var a=Object(i.a)(t[e],2),n=a[0],c=a[1];f(T(n,c))}M(10*R(s.status).done)}}),[s]),Object(n.useEffect)((function(){(N||C)&&(C?o(C):N.message?t(N.message):(a(Z),g("/create")))}),[Z,N,a,t,C,o]),Object(_.jsxs)("form",{className:"mb-3",onSubmit:V,children:[Object(_.jsxs)("div",{className:"mb-3",children:[Object(_.jsx)("label",{htmlFor:"userName",className:"form-label",children:"User name"}),Object(_.jsx)("input",{type:"text",className:"form-control",id:"userName","data-field":"username",onChange:K,value:m.username||"",disabled:w||s})]}),Object(_.jsxs)("div",{className:"mb-3",children:[Object(_.jsx)("label",{htmlFor:"userEmail",className:"form-label",children:"Email"}),Object(_.jsx)("input",{type:"email",className:"form-control",id:"userEmail","data-field":"email",onChange:K,value:m.email||"",disabled:w||s})]}),Object(_.jsxs)("div",{className:"mb-3",children:[Object(_.jsx)("label",{htmlFor:"taskText",className:"form-label",children:"Task text"}),Object(_.jsx)("textarea",{className:"form-control",id:"taskText","data-field":"text",onChange:K,value:m.text||"",disabled:w})]}),s&&Object(_.jsxs)("div",{className:"form-check mb-3",children:[Object(_.jsx)("input",{className:"form-check-input",type:"checkbox",checked:10===D,id:"done",onChange:function(){return M(D?0:10)}}),Object(_.jsx)("label",{className:"form-check-label",htmlFor:"done",children:"Done task"})]}),Object(_.jsxs)("button",{type:"submit",className:"btn btn-primary",disabled:w,children:[w&&Object(_.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status"}),"Save"]})]})},U=a(21),B=a(16),G=function(e){var t=e.id,a=e.username,n=e.email,s=e.text,c=e.status,r=e.isLoggedIn,i=e.onEditClick;return Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{scope:"row",children:t}),Object(_.jsx)("td",{children:a}),Object(_.jsx)("td",{children:n}),Object(_.jsx)("td",{children:s}),Object(_.jsx)("td",{children:D(c)}),r&&Object(_.jsx)("td",{children:Object(_.jsx)("a",{type:"button",className:"btn btn-warning","data-id":t,onClick:i,children:Object(_.jsx)(U.a,{icon:B.a})})})]})},J=function(e){return e.loading?Object(_.jsx)("div",{className:"d-flex justify-content-center m-5",children:Object(_.jsx)("div",{className:"spinner-border",role:"status",children:Object(_.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):null},z=function(e){var t=e.names,a=e.sorting,n=e.sortTasks;return t.map((function(e,t){var s=m;return e.toLowerCase()===a.field&&(s=s===a.direction?"desc":m),"edit"===e.toLowerCase()?Object(_.jsx)("th",{scope:"col",children:e},t):Object(_.jsx)("th",{scope:"col",children:Object(_.jsxs)("a",{href:"",onClick:n,"data-field":e.toLowerCase(),"data-direction":s,children:[e,a.field===e.toLowerCase()&&Object(_.jsx)(U.a,{icon:s===m?B.c:B.b})]})},t)}))},H=function(e){var t=e.tasks,a=e.loading,n=e.sorting,s=e.sortTasks,c=e.isLoggedIn,r=e.onEditClick;if(a)return Object(_.jsx)(J,{loading:a});var i=t.map((function(e){return Object(_.jsx)(G,Object(d.a)(Object(d.a)({isLoggedIn:c},e),{},{onEditClick:r}),e.id)})),o=["id","Name","Email","Description","Status"];return c&&o.push("Edit"),Object(_.jsxs)("table",{className:"table",children:[Object(_.jsx)("thead",{children:Object(_.jsx)("tr",{children:Object(_.jsx)(z,{names:o,sorting:n,sortTasks:s})})}),Object(_.jsx)("tbody",{children:!a&&i})]})},Z=a(22),q=function(e){var t=e.className,a=e.i,n=e.onPageClick;return Object(_.jsx)("li",{className:t,children:Object(_.jsx)("a",{className:"page-link",href:"","data-page":a,onClick:n,children:a})},a)},K=function(e){var t=e.total,a=e.activePage,n=e.onPageClick,s=Math.ceil(t/3);if(1===s||0===s)return null;for(var c=[],r=1;r<=s;r++){var i=r===a?"page-item active":"page-item",o=Object(_.jsx)(q,{className:i,i:r,onPageClick:n},r);c=[].concat(Object(Z.a)(c),[o])}return Object(_.jsx)("nav",{children:Object(_.jsxs)("ul",{className:"pagination justify-content-center",children:[Object(_.jsx)("li",{className:"page-item ".concat(1===a?"disabled":""),children:Object(_.jsx)("a",{className:"page-link",onClick:n,"data-direction":-1,href:"",children:"Prev"})}),c,Object(_.jsx)("li",{className:"page-item ".concat(a===s?"disabled":""),children:Object(_.jsx)("a",{className:"page-link",onClick:n,"data-direction":1,href:"",children:"Next"})})]})})},Q=a(14),V=function(e){var t=e.isLoggedIn,a=e.logout;return Object(_.jsx)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:Object(_.jsxs)("div",{className:"container-fluid",children:[Object(_.jsx)(Q.b,{to:"/",className:"navbar-brand",children:"Home"}),Object(_.jsxs)("div",{children:[!t&&Object(_.jsx)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:Object(_.jsx)("li",{className:"nav-item",children:Object(_.jsx)(Q.b,{to:"/login",className:"nav-link",children:"Login"})})}),t&&Object(_.jsx)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:Object(_.jsx)("li",{className:"nav-item",children:Object(_.jsx)(Q.b,{to:"/",className:"nav-link",onClick:a,children:"Logout"})})})]})]})})},W=a(5),X={},Y=function(e){var t=e.setToken,a=e.setError,s=Object(n.useReducer)(L,X),c=Object(i.a)(s,2),r=c[0],o=c[1],d=O("/login"),b=Object(i.a)(d,2),j=b[0],m=j.response,f=j.error,p=j.isLoading,h=b[1],v=function(e){var t=e.currentTarget,a=t.value,n=t.dataset.field;o(T(n,a))},g=Object(n.useCallback)((function(){o(E())}),[]);return Object(n.useEffect)((function(){if(m||f)return f?(console.log(f),void a(f)):void(m.message&&t(m.message.token))}),[m,t,f,a]),Object(_.jsxs)("form",{className:"mb-3",onSubmit:function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=I(r),e.next=4,h({method:"POST",form:a});case 4:g();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:[Object(_.jsxs)("div",{className:"mb-3",children:[Object(_.jsx)("label",{htmlFor:"userName",className:"form-label",children:"User name"}),Object(_.jsx)("input",{type:"text",className:"form-control",id:"userName","data-field":"username",onChange:v,value:r.username||"",disabled:p})]}),Object(_.jsxs)("div",{className:"mb-3",children:[Object(_.jsx)("label",{htmlFor:"userPassword",className:"form-label",children:"Password"}),Object(_.jsx)("input",{type:"password",className:"form-control",id:"userPassword",autoComplete:"false","data-field":"password",onChange:v,value:r.password||"",disabled:p})]}),Object(_.jsxs)("button",{type:"submit",className:"btn btn-primary",disabled:p,children:[p&&Object(_.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status"}),"Login"]})]})},$=function(e,t){switch(t.type){case f:return Object(d.a)(Object(d.a)({},e),{},{activePage:t.payload.activePage});case p:return Object(d.a)(Object(d.a)({},e),{},{sorting:{field:t.payload.field,direction:t.payload.direction}});case h:return Object(d.a)(Object(d.a)({},e),{},{tasks:t.payload.tasks,totalTaskCount:t.payload.totalTaskCount});case v:return 3===e.tasks.length?Object(d.a)(Object(d.a)({},e),{},{totalTaskCount:e.totalTaskCount+1}):Object(d.a)(Object(d.a)({},e),{},{tasks:[].concat(Object(Z.a)(e.tasks),[t.payload]),totalTaskCount:e.totalTaskCount+1});case g:var a=e.tasks.findIndex((function(e){return e.id===t.payload.task.id})),n=e.tasks;return n.splice(a,1,t.payload.task),Object(d.a)(Object(d.a)({},e),{},{tasks:n});case y:var s=(new Date).getTime();return Object(d.a)(Object(d.a)({},e),{},{token:t.payload.token,timestamp:s});case N:return Object(d.a)(Object(d.a)({},e),{},{taskId:t.payload.taskId});case C:var c=[];if("object"===typeof t.payload.error)for(var r=0,o=Object.entries(t.payload.error);r<o.length;r++){var l=Object(i.a)(o[r],2),u=l[0],b=l[1];c.push("".concat(u," - ").concat(b))}return"string"===typeof t.payload.error&&c.push(t.payload.error),Object(d.a)(Object(d.a)({},e),{},{error:c});default:return e}},ee=function(e){var t=e.error,a=e.dismiss;if(!t.length)return null;var n=t.map((function(e,t){return Object(_.jsx)("p",{children:e},t)}));return Object(_.jsxs)("div",{className:"alert alert-danger alert-dismissible fade show",role:"alert",children:[n,Object(_.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"alert","aria-label":"Close",onClick:function(){a([])}})]})},te={activePage:1,tasks:[],totalTaskCount:0,sorting:{field:"id",direction:"abc"},token:null,timestamp:null,taskId:null,error:[]};var ae=function(){var e,t,a=Object(n.useReducer)($,te),s=Object(i.a)(a,2),c=s[0],r=s[1],o=O("/"),l=Object(i.a)(o,2),d=l[0],u=d.response,b=d.error,j=d.isLoading,m=l[1],x=Object(n.useState)(!0),k=Object(i.a)(x,2),y=k[0],N=k[1],T=Object(n.useCallback)((function(e,t){r(function(e,t){return{type:h,payload:{tasks:e,totalTaskCount:+t}}}(e,t))}),[]),E=Object(n.useCallback)((function(e){r(function(e){return{type:v,payload:e}}(e))}),[]),P=Object(n.useCallback)((function(e){r(function(e){return{type:g,payload:{task:e}}}(e))}),[]),L=Object(n.useCallback)((function(e){r(w(e))}),[]),I=Object(n.useCallback)((function(e){if(e){var t=e.currentTarget.dataset.id;r(S(parseInt(t)))}else r(S(null))}),[]),F=Object(n.useCallback)((function(e){r(function(e){return{type:C,payload:{error:e}}}(e))}),[]),D=(e=c.token,t=c.timestamp,!(!e||!t)&&!(!e||!t)&&(new Date).getTime()-t<864e5),R=function(e,t){var a=t.findIndex((function(t){return t.id===e}));return t[a]}(c.taskId,c.tasks);return Object(n.useEffect)((function(){if(y){var e=c.activePage,t=c.sorting,a=t.field,n=t.direction;m({params:{sort_field:a,sort_direction:n,page:e.toString()}}),N(!1)}}),[m,u,c,y]),Object(n.useEffect)((function(){if((u||b)&&(b&&F(b),u&&u.message)){var e=u.message,t=e.tasks,a=e.total_task_count;T(t,a)}}),[u,b,T,F]),Object(_.jsx)("div",{className:"App",children:Object(_.jsxs)(Q.a,{children:[Object(_.jsx)(V,{isLoggedIn:D,logout:function(){r(w(null))}}),Object(_.jsx)("div",{className:"container",children:Object(_.jsx)("div",{className:"row",children:Object(_.jsxs)("div",{className:"col",children:[Object(_.jsx)(ee,{error:c.error,dismiss:F}),Object(_.jsxs)(W.d,{children:[Object(_.jsx)(W.b,{path:"/login",children:D?Object(_.jsx)(W.a,{to:"/"}):Object(_.jsx)(Y,{setToken:L,setError:F})}),Object(_.jsxs)(W.b,{path:"/",children:[Object(_.jsx)(M,{setTaskToState:E,setEditedTaskToState:P,taskToEdit:R,setId:I,token:c.token,setError:F}),Object(_.jsx)(H,{tasks:c.tasks,loading:j,sortTasks:function(e){e.preventDefault();var t=e.currentTarget.dataset,a=t.field,n=t.direction;r(function(e,t){return{type:p,payload:{field:e,direction:t}}}(a,n)),N(!0)},sorting:c.sorting,isLoggedIn:D,onEditClick:I}),Object(_.jsx)(K,{total:c.totalTaskCount,activePage:c.activePage,onPageClick:function(e){e.preventDefault();var t=e.currentTarget.dataset,a=t.page,n=void 0===a?c.activePage:a,s=t.direction;r({type:f,payload:{activePage:+n+ +(void 0===s?0:s)}}),N(!0)}})]})]})]})})})]})})},ne=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,72)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))};r.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(ae,{})}),document.getElementById("root")),ne()}},[[71,1,2]]]);
//# sourceMappingURL=main.33ffc09d.chunk.js.map